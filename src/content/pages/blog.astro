---
// 从 Astro 内容集合中获取 Strapi 文章
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

// 获取在 content.config.ts 中定义的 'strapi-articles' 集合
const strapiArticles = await getCollection('strapi-articles');
---

<Layout title="来自 Strapi 的博客">
  <h1>我们的博客 (内容来自 Strapi)</h1>
  
  {strapiArticles.length > 0 ? (
    <div class="articles-grid">
      {strapiArticles.map((article) => (
        <article class="article-card">
          <h2>{article.data.title}</h2>
          {/* 安全地处理可能未填充的字段 */}
          {article.data.description && <p>{article.data.description}</p>}
          {article.data.publishedAt && (
            <time>
              发布于: {new Date(article.data.publishedAt).toLocaleDateString('zh-CN')}
            </time>
          )}
          {/* 
            注意：访问深层嵌套数据（如 article.data.cover.data.attributes.url）时，
            请确保这些数据已在 `populate` 查询中正确请求，并做好错误处理。
          */}
        </article>
      ))}
    </div>
  ) : (
    <p>暂无文章，请检查 Strapi 连接或内容填充配置。</p>
  )}
</Layout>

<style>
  .articles-grid {
    display: grid;
    gap: 2rem;
  }
  .article-card {
    padding: 1.5rem;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    background: #fff;
  }
</style>
