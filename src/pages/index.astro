---
// --- 第一部分：现有导入保持不变 ---
import BaseLayout from '@/layouts/BaseLayout.astro'
import siteConfig from '@/site-config'
// --- 新增导入：引入Strapi博客获取函数 ---
import { getStrapiBlogs } from '@/lib/strapi'

// --- 第二部分：获取数据 ---
// 获取所有Strapi博客文章，并按日期倒序排列
const allStrapiBlogs = await getStrapiBlogs()
// 取出最新的3篇文章用于首页展示
const latestStrapiBlogs = allStrapiBlogs.slice(0, 3)
---
<BaseLayout description={siteConfig.description}>
  <article class="prose">
    <!-- 原有的标题和介绍内容保持不变 -->
    <h1 class="text-title">Vitesse theme</h1>
    <p>Vitesse theme for Astro, supports Vue and UnoCSS.</p>
    <!-- ... 中间你原有的所有段落内容保持不变 ... -->
    
    <!-- --- 新增部分：最新Strapi博客列表 --- -->
    <hr class="hr-line" />
    <h2>Latest from Strapi Blog</h2>
    {
      latestStrapiBlogs.length > 0 ? (
        <ul>
          {latestStrapiBlogs.map((post) => (
            <li>
              <a href={`/strapi-blog/${post.slug}`} class="prose-link">
                {post.title}
              </a>
              <small> – By {post.author} on {post.date.toLocaleDateString()}</small>
            </li>
          ))}
        </ul>
      ) : (
        <p>No blog posts yet.</p>
      )
    }
    <p>
      <a href="/strapi-blog" class="prose-link">View all Strapi Blogs →</a>
    </p>
    <!-- --- 新增部分结束 --- -->
    
    <hr class="hr-line" />
    <!-- 原有的“Find me on”等社交链接部分保持不变 -->
    <p>Find me on</p>
    <p class="flex gap-x-4 gap-y-2 flex-wrap">
      {
        siteConfig.socialLinks.map((link) => (
          <a aria-label={link.text} href={link.href} target="_blank" class="prose-link">
            <i class:list={[link.icon]} />
            {link.text}
          </a>
        ))
      }
    </p>
    <!-- ... 其余原有内容 ... -->
  </article>
</BaseLayout>
