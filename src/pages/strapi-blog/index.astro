---
// src/pages/strapi-blog/index.astro
import BaseLayout from '@/layouts/BaseLayout.astro'
import siteConfig from '@/site-config'
import { getStrapiBlogs } from '@/lib/strapi'

// 获取所有博客文章
const posts = await getStrapiBlogs()
---

<BaseLayout title="Strapi Blog" description="All blog posts fetched from Strapi CMS.">
  <h1 class="text-title">Strapi Blog</h1>
  <p class="opacity-80">All articles are managed and delivered from Strapi.</p>
  
  <hr class="hr-line my-8" />
  
  {
    posts.length > 0 ? (
      <ul class="space-y-6">
        {posts.map((post) => (
          <li class="border-b pb-6 border-gray-200 dark:border-gray-800">
            <article>
              <h2 class="text-2xl font-bold mb-2">
                <a href={`/strapi-blog/${post.slug}`} class="text-primary hover:underline">
                  {post.title}
                </a>
              </h2>
              <div class="flex gap-4 text-sm opacity-60 mb-3">
                <span>By {post.author}</span>
                <span>|</span>
                <time>{post.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</time>
              </div>
              {post.cover && (
                <img src={post.cover} alt={`Cover for ${post.title}`} class="rounded-lg mb-4 w-full max-w-2xl" />
              )}
              <p class="mt-2">
                <a href={`/strapi-blog/${post.slug}`} class="text-primary font-medium hover:underline">
                  Read full article →
                </a>
              </p>
            </article>
          </li>
        ))}
      </ul>
    ) : (
      <p>No blog posts have been published yet.</p>
    )
  }
</BaseLayout>
