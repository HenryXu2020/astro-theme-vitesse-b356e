---
import BaseLayout from '@/layouts/BaseLayout.astro'
import { getStrapiBlogs } from '@/lib/strapi'
// 获取所有文章
const blogs = await getStrapiBlogs()
---

<BaseLayout title="Strapi Blog" description="Blog posts loaded from Strapi CMS.">
  <article class="prose">
    <h1>Strapi Blog</h1>
    <p>All posts are managed and delivered from Strapi.</p>
    
    <hr class="hr-line" />
    
    {
      blogs.length > 0 ? (
        <ul class="space-y-8">
          {blogs.map((blog) => (
            <li class="border-b pb-6">
              <h2 class="!mt-0 !mb-2">
                <a href={`/strapi-blog/${blog.slug}`} class="prose-link no-underline hover:underline">
                  {blog.title}
                </a>
              </h2>
              <p class="!mt-0 text-sm text-gray-500">By {blog.author} • {new Date(blog.publishedAt).toDateString()}</p>
              {blog.cover?.url && (
                <img src={blog.cover.url} alt={`Cover for ${blog.title}`} class="rounded w-full max-w-2xl" />
              )}
              {blog.excerpt && <p>{blog.excerpt}</p>}
              <a href={`/strapi-blog/${blog.slug}`} class="text-sm font-semibold prose-link">Read more →</a>
            </li>
          ))}
        </ul>
      ) : (
        <p>No blog posts found.</p>
      )
    }
  </article>
</BaseLayout>
